define(["require","exports","./LIC/JSlic","knockout","jquery-mousewheel","knockout-jqueryui/tooltip"],function(a,b,c,d){"use strict";var e=function(){function a(){var a=this;this.inputX="pow(y,2)",this.inputY="-x",this.top=2,this.bottom=-2,this.left=-2,this.right=2,this.AverageTime=d.observable("0"),this.InputX=d.pureComputed({read:function(){return a.inputX},write:function(b){a.inputX=b,a.sendMessage()},owner:this}),this.InputY=d.pureComputed({read:function(){return a.inputY},write:function(b){a.inputY=b,a.sendMessage()},owner:this}),this.Top=d.pureComputed({read:function(){return a.top},write:function(b){a.top=b,a.checkBounds(a.errorTop)&&a.sendMessage()},owner:this}),this.Bottom=d.pureComputed({read:function(){return a.bottom},write:function(b){a.bottom=b,a.checkBounds(a.errorBottom)&&a.sendMessage()},owner:this}),this.Left=d.pureComputed({read:function(){return a.left},write:function(b){a.left=b,a.checkBounds(a.errorLeft)&&a.sendMessage()},owner:this}),this.Right=d.pureComputed({read:function(){return a.right},write:function(b){a.right=b,a.checkBounds(a.errorRight)&&a.sendMessage()},owner:this}),this.parserWorker=new Worker("./Build/Workers/BootWorker.js"),this.errorX=d.observable(!0),this.errorY=d.observable(!0),this.errorTop=d.observable(!0),this.errorBottom=d.observable(!0),this.errorLeft=d.observable(!0),this.errorRight=d.observable(!0),this.toolTipX=d.observable(""),this.toolTipY=d.observable(""),this.toolTipBound=d.observable("Vertical and horizontal spaces must be the same"),this.mousedown=function(b,c){a.isMousedown=!0,a.mousePos=[c.clientX,c.clientY],a.model.startAnimation()},this.mouseup=function(){a.isMousedown=!1,a.model.stopAnimation(),a.AverageTime(a.model.AverageRenderTime.toFixed(4))},this.mousemove=function(b,c){if(a.isMousedown){var d=c.clientX-a.mousePos[0],e=a.mousePos[1]-c.clientY;d&&a.model.moveX(d),e&&a.model.moveY(e),a.mousePos=[c.clientX,c.clientY]}},this.restoreModel=function(){a.model.restore()},this.canvas=$(".webglCanvas").get(0),this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight,this.model=new c.JSLIC(this.canvas),this.parserWorker.onmessage=function(b){a.handleMessage(b.data)},$(".webglCanvas").mousewheel(function(b){a.model.scale(b.deltaY),a.model.render(),a.AverageTime(a.model.AverageRenderTime.toFixed(4))}),$.when(this.model.loadNoiseTexture()).done(function(){a.sendMessage()})}return a.prototype.handleMessage=function(a){var b=this;switch(a.type){case"error":a.error.errorX?(this.errorX(!1),this.toolTipX(a.error.errorX)):this.errorX(!0),a.error.errorY?(this.errorY(!1),this.toolTipY(a.error.errorY)):this.errorY(!0);break;case"parsed":this.errorX(!0),this.errorY(!0);break;case"value":$.when(this.model.loadFieldTexture(a.field)).done(function(){b.model.render(),b.AverageTime(b.model.AverageRenderTime.toFixed(4))})}},a.prototype.sendMessage=function(){var a={input:{x:this.inputX,y:this.inputY},bounds:{left:this.left,right:this.right,top:this.top,bottom:this.bottom},size:1024};this.parserWorker.postMessage(a)},a.prototype.checkBounds=function(a){return this.left>this.right||this.bottom>this.top||this.right-this.left!==this.top-this.bottom?(a(!1),!1):(this.errorBottom(!0),this.errorLeft(!0),this.errorRight(!0),this.errorTop(!0),!0)},a}();d.applyBindings(new e)});